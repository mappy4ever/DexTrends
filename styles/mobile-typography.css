/**
 * Mobile Typography System
 * Fixes text display, scaling, and readability issues
 */

/* ========================================
   Root Typography Variables
   ======================================== */
:root {
  /* Base font sizes */
  --font-xs: 0.75rem;    /* 12px */
  --font-sm: 0.875rem;   /* 14px */
  --font-base: 1rem;     /* 16px */
  --font-lg: 1.125rem;   /* 18px */
  --font-xl: 1.25rem;    /* 20px */
  --font-2xl: 1.5rem;    /* 24px */
  --font-3xl: 1.875rem;  /* 30px */
  --font-4xl: 2.25rem;   /* 36px */
  
  /* Line heights */
  --line-tight: 1.25;
  --line-snug: 1.375;
  --line-normal: 1.5;
  --line-relaxed: 1.625;
  --line-loose: 2;
  
  /* Letter spacing */
  --tracking-tight: -0.025em;
  --tracking-normal: 0;
  --tracking-wide: 0.025em;
  --tracking-wider: 0.05em;
}

/* ========================================
   Mobile-First Typography Scale
   ======================================== */

/* Base (320px - 374px) */
@media (max-width: 374px) {
  :root {
    --font-scale: 0.875;
  }
  
  html {
    font-size: 14px;
  }
  
  /* Prevent vertical text on smallest screens */
  * {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
  }
  
  /* Headings */
  h1, .text-4xl, .text-5xl {
    font-size: 1.75rem !important; /* 28px */
    line-height: var(--line-tight) !important;
    letter-spacing: var(--tracking-tight) !important;
    word-break: break-word !important;
    hyphens: auto !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  h2, .text-3xl {
    font-size: 1.5rem !important; /* 24px */
    line-height: var(--line-tight) !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  h3, .text-2xl {
    font-size: 1.25rem !important; /* 20px */
    line-height: var(--line-snug) !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  h4, .text-xl {
    font-size: 1.125rem !important; /* 18px */
    line-height: var(--line-snug) !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  /* Body text */
  p, .text-base {
    font-size: 0.875rem !important; /* 14px */
    line-height: var(--line-relaxed) !important;
  }
  
  /* Small text */
  .text-sm {
    font-size: 0.8125rem !important; /* 13px */
  }
  
  .text-xs {
    font-size: 0.75rem !important; /* 12px */
  }
}

/* Medium (375px - 419px) */
@media (min-width: 375px) and (max-width: 419px) {
  :root {
    --font-scale: 0.9375;
  }
  
  html {
    font-size: 15px;
  }
  
  h1, .text-4xl, .text-5xl {
    font-size: 2rem !important; /* 32px */
    line-height: var(--line-tight) !important;
  }
  
  h2, .text-3xl {
    font-size: 1.625rem !important; /* 26px */
  }
  
  h3, .text-2xl {
    font-size: 1.375rem !important; /* 22px */
  }
  
  p, .text-base {
    font-size: 0.9375rem !important; /* 15px */
  }
}

/* Large (420px - 767px) */
@media (min-width: 420px) and (max-width: 767px) {
  :root {
    --font-scale: 1;
  }
  
  html {
    font-size: 16px;
  }
  
  h1, .text-4xl, .text-5xl {
    font-size: 2.25rem !important; /* 36px */
    line-height: var(--line-tight) !important;
  }
  
  h2, .text-3xl {
    font-size: 1.875rem !important; /* 30px */
  }
  
  h3, .text-2xl {
    font-size: 1.5rem !important; /* 24px */
  }
}

/* ========================================
   Fix Text Display Issues
   ======================================== */

/* Prevent vertical text display */
@media (max-width: 768px) {
  /* Reset any problematic text styles */
  * {
    writing-mode: initial !important;
    text-orientation: initial !important;
  }
  
  /* Prevent unintended text rotations only for text elements */
  h1, h2, h3, h4, h5, h6, p, span, div[class*="text"], 
  [class*="title"], [class*="name"], [class*="label"] {
    transform: none !important;
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    direction: ltr !important;
  }
  
  /* Allow transforms for non-text elements and animations */
  img, svg, .motion-div, [class*="motion"], 
  .framer-motion, .animate, .transition,
  .intentional-transform {
    transform: inherit !important;
  }
  
  /* Fix word breaking */
  p, span, div, h1, h2, h3, h4, h5, h6 {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: normal !important;
    hyphens: manual !important;
    -webkit-hyphens: manual !important;
    -moz-hyphens: manual !important;
    -ms-hyphens: manual !important;
  }
  
  /* Prevent single character per line */
  .region-title,
  .region-name,
  [class*="region"] h1,
  [class*="region"] h2,
  [class*="region"] h3 {
    min-width: 100% !important;
    white-space: normal !important;
    display: block !important;
    text-align: left !important;
  }
  
  /* Fix flex container text issues */
  .flex h1, .flex h2, .flex h3,
  .flex-col h1, .flex-col h2, .flex-col h3 {
    flex-shrink: 0 !important;
    width: 100% !important;
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
  
  /* Fix grid container text issues */
  .grid h1, .grid h2, .grid h3,
  [class*="grid"] h1, [class*="grid"] h2, [class*="grid"] h3 {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
}

/* ========================================
   Region Page Specific Fixes
   ======================================== */

@media (max-width: 768px) {
  /* Region hero text */
  .region-hero h1,
  [id*="region"] h1 {
    font-size: 2rem !important;
    line-height: 1.2 !important;
    text-align: center !important;
    width: 100% !important;
    display: block !important;
    white-space: normal !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  /* Region description */
  .region-description,
  [class*="region"] p {
    font-size: 0.9375rem !important;
    line-height: 1.6 !important;
    text-align: left !important;
    display: block !important;
  }
  
  /* Fix badge/icon text */
  .badge-text,
  .icon-label {
    white-space: nowrap !important;
    display: inline-block !important;
    writing-mode: horizontal-tb !important;
    transform: none !important;
  }
  
  /* Gym leader names and region titles */
  .gym-leader-name,
  .elite-four-name,
  .champion-name,
  .region-title,
  .region-hero-title,
  .region-hero-description,
  [class*="leader"] h1,
  [class*="leader"] h2,
  [class*="leader"] h3,
  [class*="gym"] h1,
  [class*="gym"] h2,
  [class*="gym"] h3,
  [class*="elite"] h1,
  [class*="elite"] h2,
  [class*="elite"] h3,
  [class*="champion"] h1,
  [class*="champion"] h2,
  [class*="champion"] h3 {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
    display: block !important;
    width: 100% !important;
    text-align: center !important;
    white-space: normal !important;
  }
  
  /* Region hero specific fixes */
  .region-hero-title {
    font-size: 2.5rem !important;
    line-height: 1.1 !important;
    letter-spacing: -1px !important;
  }
  
  .region-hero-description {
    font-size: 1rem !important;
    line-height: 1.4 !important;
    max-width: 90% !important;
    margin: 0 auto 2rem !important;
  }
  
  /* Motion/Animation container text fixes */
  .motion-div h1, .motion-div h2, .motion-div h3,
  [data-framer-appear-id] h1, [data-framer-appear-id] h2, [data-framer-appear-id] h3,
  div[style*="transform"] h1, div[style*="transform"] h2, div[style*="transform"] h3 {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
  }
  
  /* Ensure text in all animated elements stays horizontal */
  [class*="motion"] h1, [class*="motion"] h2, [class*="motion"] h3,
  [class*="animate"] h1, [class*="animate"] h2, [class*="animate"] h3 {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
  
  /* Prevent vertical text in any rotated or transformed containers */
  [style*="rotate"] h1, [style*="rotate"] h2, [style*="rotate"] h3,
  [style*="rotateY"] h1, [style*="rotateY"] h2, [style*="rotateY"] h3,
  [class*="rotate"] h1, [class*="rotate"] h2, [class*="rotate"] h3 {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
  }
  
  /* Force all trainer/character names to display horizontally */
  [class*="name"] {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    transform: none !important;
    display: inline-block !important;
    white-space: nowrap !important;
    max-width: 100% !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
}

/* ========================================
   Pokemon Card Text
   ======================================== */

@media (max-width: 768px) {
  /* Pokemon names */
  .pokemon-name,
  [class*="pokemon-card"] h3,
  [class*="Card"] h3 {
    font-size: 0.875rem !important;
    line-height: 1.2 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
    max-width: 100% !important;
  }
  
  /* Two-line truncation for descriptions */
  .pokemon-description,
  .card-description {
    display: -webkit-box !important;
    -webkit-line-clamp: 2 !important;
    -webkit-box-orient: vertical !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    line-height: 1.4 !important;
  }
}

/* ========================================
   Input & Form Typography
   ======================================== */

@media (max-width: 768px) {
  /* Prevent zoom on input focus (iOS) */
  input, textarea, select {
    font-size: 16px !important;
    line-height: 1.5 !important;
  }
  
  /* Placeholder text */
  ::placeholder {
    font-size: 14px !important;
    opacity: 0.7;
  }
  
  /* Label text */
  label {
    font-size: 14px !important;
    font-weight: 500;
    line-height: 1.5 !important;
  }
}

/* ========================================
   Safe Area Text Padding
   ======================================== */

@media (max-width: 768px) {
  /* Add padding for notch/home indicator */
  .safe-text {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  /* Header text */
  header h1, header h2 {
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }
}

/* ========================================
   Accessibility & Readability
   ======================================== */

/* High contrast mode */
@media (prefers-contrast: high) {
  body {
    font-weight: 500;
  }
  
  h1, h2, h3, h4, h5, h6 {
    font-weight: 700;
  }
}

/* Dark mode adjustments */
@media (max-width: 768px) {
  .dark {
    /* Slightly larger text in dark mode for readability */
    font-size: calc(1em * 1.05);
    
    /* Better contrast */
    --tw-text-opacity: 0.95;
  }
}

/* ========================================
   Performance Optimizations
   ======================================== */

@media (max-width: 768px) {
  /* Use system fonts for better performance */
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, 
                 "Helvetica Neue", Arial, sans-serif;
  }
  
  /* Optimize font loading */
  .font-display-swap {
    font-display: swap;
  }
  
  /* Reduce font weights on mobile */
  .font-black { font-weight: 800; }
  .font-bold { font-weight: 700; }
  .font-semibold { font-weight: 600; }
  .font-medium { font-weight: 500; }
  .font-normal { font-weight: 400; }
  .font-light { font-weight: 300; }
}

/* ========================================
   Debug Mode (Remove in Production)
   ======================================== */

/* Uncomment to debug text issues */
/*
@media (max-width: 768px) {
  * {
    outline: 1px solid red !important;
  }
  
  h1, h2, h3, h4, h5, h6 {
    background: rgba(255, 0, 0, 0.1) !important;
  }
  
  p {
    background: rgba(0, 255, 0, 0.1) !important;
  }
}
*/